---
import BaseLayout from './BaseLayout.astro';

export interface Props {
  location: {
    name: string;
    state: string;
    region: string;
    slug: string;
    seo: {
      title: string;
      description: string;
    };
    coordinates?: {
      lat: number;
      lng: number;
    };
  };
}

const { location } = Astro.props;

const geoRegion = location.region === 'SC' ? 'US-SC' : 'US-NC';
const geoPlacename = location.name;

// LocalBusiness schema for the location
const localBusinessSchema = {
  "@context": "https://schema.org",
  "@type": "HomeAndConstructionBusiness",
  "@id": `https://www.ifixxnc.com/service-areas/${location.slug}#business`,
  "name": "iFixx Remodeling & Handyman Services",
  "description": location.seo.description,
  "url": `https://www.ifixxnc.com/service-areas/${location.slug}`,
  "telephone": "+1-980-391-6833",
  "email": "info@ifixxnc.com",
  "priceRange": "$$",
  "image": "https://www.ifixxnc.com/images/ui/hero-bg.jpg",
  "logo": "https://www.ifixxnc.com/images/logo.png",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": location.name,
    "addressRegion": location.state,
    "addressCountry": "US"
  },
  ...(location.coordinates && {
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": location.coordinates.lat,
      "longitude": location.coordinates.lng
    }
  }),
  "areaServed": {
    "@type": "City",
    "name": location.name,
    "containedInPlace": {
      "@type": "State",
      "name": location.state === 'NC' ? 'North Carolina' : 'South Carolina'
    }
  },
  "openingHoursSpecification": [
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
      "opens": "07:00",
      "closes": "18:00"
    },
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": "Saturday",
      "opens": "08:00",
      "closes": "14:00"
    }
  ],
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "reviewCount": "127",
    "bestRating": "5",
    "worstRating": "1"
  },
  "sameAs": [
    "https://www.facebook.com/ifixxnc",
    "https://www.instagram.com/ifixxnc/"
  ]
};

// Breadcrumb schema
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://www.ifixxnc.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Service Areas",
      "item": "https://www.ifixxnc.com/service-areas"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": `${location.name}, ${location.state}`,
      "item": `https://www.ifixxnc.com/service-areas/${location.slug}`
    }
  ]
};
---

<BaseLayout
  title={location.seo.title}
  description={location.seo.description}
  canonical={`/service-areas/${location.slug}`}
  geoRegion={geoRegion}
  geoPlacename={geoPlacename}
>
  <Fragment slot="schema">
    <script type="application/ld+json" set:html={JSON.stringify(localBusinessSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
  </Fragment>

  <slot />
</BaseLayout>
